{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-07-12T21:55:31.755036Z", "invocation_id": "9d47a6c1-916f-45ad-a0be-bbf8e8606b17", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.536959Z", "completed_at": "2024-07-12T21:55:30.561310Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.569025Z", "completed_at": "2024-07-12T21:55:30.569041Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03261303901672363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__email_base", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"sfmc_integration_tests_06\".\"email_data\"", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__email_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.561559Z", "completed_at": "2024-07-12T21:55:30.570196Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.571045Z", "completed_at": "2024-07-12T21:55:30.571049Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011422872543334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__event_base", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"sfmc_integration_tests_06\".\"event_data\"", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__event_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.564032Z", "completed_at": "2024-07-12T21:55:30.570467Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.571419Z", "completed_at": "2024-07-12T21:55:30.571422Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011490821838378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__link_base", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"sfmc_integration_tests_06\".\"link_data\"", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.566502Z", "completed_at": "2024-07-12T21:55:30.570846Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.574393Z", "completed_at": "2024-07-12T21:55:30.574397Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014198064804077148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__link_send_base", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"sfmc_integration_tests_06\".\"link_send_data\"", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link_send_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.571777Z", "completed_at": "2024-07-12T21:55:30.576312Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.577225Z", "completed_at": "2024-07-12T21:55:30.577230Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007346153259277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__list_base", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"sfmc_integration_tests_06\".\"list_data\"", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.577959Z", "completed_at": "2024-07-12T21:55:30.587935Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.590855Z", "completed_at": "2024-07-12T21:55:30.590861Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014889955520629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__list_subscriber_base", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"sfmc_integration_tests_06\".\"list_subscriber_data\"", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list_subscriber_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.581387Z", "completed_at": "2024-07-12T21:55:30.588169Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.591253Z", "completed_at": "2024-07-12T21:55:30.591263Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014766931533813477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__send_base", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"sfmc_integration_tests_06\".\"send_data\"", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__send_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.584643Z", "completed_at": "2024-07-12T21:55:30.590625Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.591733Z", "completed_at": "2024-07-12T21:55:30.591739Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015011072158813477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__subscriber_base", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"sfmc_integration_tests_06\".\"subscriber_data\"", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__subscriber_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.588359Z", "completed_at": "2024-07-12T21:55:30.592488Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.593725Z", "completed_at": "2024-07-12T21:55:30.593729Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006541728973388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__triggered_send_base", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"sfmc_integration_tests_06\".\"triggered_send_data\"", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__triggered_send_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.595565Z", "completed_at": "2024-07-12T21:55:30.596782Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.600641Z", "completed_at": "2024-07-12T21:55:30.600646Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007264137268066406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.salesforce_marketing_cloud_integration_tests.email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.597364Z", "completed_at": "2024-07-12T21:55:30.598399Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.601257Z", "completed_at": "2024-07-12T21:55:30.601260Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007245063781738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.salesforce_marketing_cloud_integration_tests.event_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.598621Z", "completed_at": "2024-07-12T21:55:30.600368Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.601609Z", "completed_at": "2024-07-12T21:55:30.601613Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007389068603515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.salesforce_marketing_cloud_integration_tests.link_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.602267Z", "completed_at": "2024-07-12T21:55:30.603350Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.604307Z", "completed_at": "2024-07-12T21:55:30.604311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007261037826538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.salesforce_marketing_cloud_integration_tests.link_send_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.605874Z", "completed_at": "2024-07-12T21:55:30.606901Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.609651Z", "completed_at": "2024-07-12T21:55:30.609655Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0056400299072265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.salesforce_marketing_cloud_integration_tests.list_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.607306Z", "completed_at": "2024-07-12T21:55:30.608284Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.610162Z", "completed_at": "2024-07-12T21:55:30.610165Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005558013916015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.salesforce_marketing_cloud_integration_tests.list_subscriber_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.608483Z", "completed_at": "2024-07-12T21:55:30.609458Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.610463Z", "completed_at": "2024-07-12T21:55:30.610466Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0056421756744384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.salesforce_marketing_cloud_integration_tests.send_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.610962Z", "completed_at": "2024-07-12T21:55:30.611935Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.612935Z", "completed_at": "2024-07-12T21:55:30.612939Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005955219268798828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.salesforce_marketing_cloud_integration_tests.subscriber_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.614816Z", "completed_at": "2024-07-12T21:55:30.616658Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:30.644360Z", "completed_at": "2024-07-12T21:55:30.644369Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03176307678222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.salesforce_marketing_cloud_integration_tests.triggered_send_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.653188Z", "completed_at": "2024-07-12T21:55:31.041080Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.041704Z", "completed_at": "2024-07-12T21:55:31.041711Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.41478586196899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__link_send", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select\n        \"link_id\",\n  \"send_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\"\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link_send_base\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    link_id\n    \n as \n    \n    link_id\n    \n, \n    \n    \n    send_id\n    \n as \n    \n    send_id\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation,\n        cast(link_id as TEXT) as link_id,\n        cast(send_id as TEXT) as send_id\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link_send\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.617213Z", "completed_at": "2024-07-12T21:55:31.041915Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.042563Z", "completed_at": "2024-07-12T21:55:31.042568Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4545919895172119, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__email", "compiled": true, "compiled_code": "with base as (\n\n    select\n        \"id\",\n  \"_fivetran_active\",\n  \"_fivetran_synced\",\n  \"character_set\",\n  \"created_date\",\n  \"modified_date\",\n  \"name\",\n  \"pre_header\",\n  \"subject\",\n  \"text_body\",\n  \"asset_type_id\",\n  \"asset_id\",\n  \"_fivetran_start\",\n  \"_fivetran_end\"\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__email_base\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_active\n    \n as \n    \n    _fivetran_active\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    _fivetran_end\n    \n as \n    \n    _fivetran_end\n    \n, \n    \n    \n    asset_id\n    \n as \n    \n    asset_id\n    \n, \n    \n    \n    asset_type_id\n    \n as \n    \n    asset_type_id\n    \n, \n    \n    \n    character_set\n    \n as \n    \n    character_set\n    \n, \n    \n    \n    created_date\n    \n as \n    \n    created_date\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    modified_date\n    \n as \n    \n    modified_date\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    pre_header\n    \n as \n    \n    pre_header\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    text_body\n    \n as \n    \n    text_body\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation,\n        asset_id,\n        asset_type_id,\n        character_set,\n        created_date,\n        cast(id as TEXT) as email_id,\n        modified_date,\n        name as email_name,\n        pre_header,\n        subject,\n        text_body\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__email\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.645754Z", "completed_at": "2024-07-12T21:55:31.042340Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.042841Z", "completed_at": "2024-07-12T21:55:31.042845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.45152807235717773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__link", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select\n        \"id\",\n  \"alias\",\n  \"total_clicks\",\n  \"unique_clicks\",\n  \"url\",\n  \"last_clicked\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"created_date\",\n  \"modified_date\"\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link_base\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    alias\n    \n as \n    \n    alias\n    \n, \n    \n    \n    last_clicked\n    \n as \n    \n    last_clicked\n    \n, \n    \n    \n    created_date\n    \n as \n    \n    created_date\n    \n, \n    \n    \n    modified_date\n    \n as \n    \n    modified_date\n    \n, \n    \n    \n    total_clicks\n    \n as \n    \n    total_clicks\n    \n, \n    \n    \n    unique_clicks\n    \n as \n    \n    unique_clicks\n    \n, \n    cast(null as TEXT) as \n    \n    url \n    \n \n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation,\n        cast(id as TEXT) as link_id,\n        alias as link_alias,\n        last_clicked as link_last_clicked,\n        created_date,\n        modified_date,\n        total_clicks as link_total_clicks,\n        unique_clicks as link_unique_clicks,\n        url as link_url\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:30.629649Z", "completed_at": "2024-07-12T21:55:31.041477Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.042120Z", "completed_at": "2024-07-12T21:55:31.042123Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.45529699325561523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__event", "compiled": true, "compiled_code": "with base as (\n\n    select \n        \"event_type\",\n  \"id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"batch_id\",\n  \"bounce_category\",\n  \"bounce_type\",\n  \"created_date\",\n  \"event_date\",\n  \"modified_date\",\n  \"opt_in_subscriber_key\",\n  \"question\",\n  \"send_id\",\n  \"smtp_code\",\n  \"smtp_reason\",\n  \"subscriber_key\",\n  \"triggered_send_id\",\n  \"unsubscribed_list_id\",\n  \"url\"\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__event_base\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    batch_id\n    \n as \n    \n    batch_id\n    \n, \n    \n    \n    bounce_category\n    \n as \n    \n    bounce_category\n    \n, \n    \n    \n    bounce_type\n    \n as \n    \n    bounce_type\n    \n, \n    \n    \n    created_date\n    \n as \n    \n    created_date\n    \n, \n    \n    \n    event_date\n    \n as \n    \n    event_date\n    \n, \n    \n    \n    event_type\n    \n as \n    \n    event_type\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    modified_date\n    \n as \n    \n    modified_date\n    \n, \n    \n    \n    opt_in_subscriber_key\n    \n as \n    \n    opt_in_subscriber_key\n    \n, \n    \n    \n    question\n    \n as \n    \n    question\n    \n, \n    \n    \n    send_id\n    \n as \n    \n    send_id\n    \n, \n    \n    \n    smtp_code\n    \n as \n    \n    smtp_code\n    \n, \n    \n    \n    smtp_reason\n    \n as \n    \n    smtp_reason\n    \n, \n    \n    \n    subscriber_key\n    \n as \n    \n    subscriber_key\n    \n, \n    \n    \n    triggered_send_id\n    \n as \n    \n    triggered_send_id\n    \n, \n    \n    \n    unsubscribed_list_id\n    \n as \n    \n    unsubscribed_list_id\n    \n, \n    \n    \n    url\n    \n as \n    \n    url\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation,\n        batch_id,\n        bounce_category,\n        bounce_type,\n        cast(created_date as date) as created_date,\n        cast(event_date as date) as event_date,\n        event_type,\n        cast(id as TEXT) as event_id,\n        modified_date,\n        opt_in_subscriber_key,\n        question,\n        cast(send_id as TEXT) as send_id,\n        smtp_code,\n        smtp_reason,\n        subscriber_key,\n        triggered_send_id,\n        unsubscribed_list_id,\n        url as event_url\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.069719Z", "completed_at": "2024-07-12T21:55:31.380464Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.382628Z", "completed_at": "2024-07-12T21:55:31.382637Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3551671504974365, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__list", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select\n        \"id\",\n  \"_fivetran_synced\",\n  \"created_date\",\n  \"description\",\n  \"modified_date\",\n  \"name\",\n  \"type\"\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list_base\"\n),\n\nfields as (\n\n    select\n        \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n , \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as timestamp) as \n    \n    _fivetran_start\n    \n , \n    cast(null as timestamp) as \n    \n    _fivetran_end\n    \n , \n    \n    \n    created_date\n    \n as \n    \n    created_date\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    modified_date\n    \n as \n    \n    modified_date\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation,\n        created_date,\n        description as list_description,\n        cast(id as TEXT) as list_id,\n        modified_date,\n        name as list_name,\n        type as list_type\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.085433Z", "completed_at": "2024-07-12T21:55:31.404709Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.404994Z", "completed_at": "2024-07-12T21:55:31.405001Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.35402989387512207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__subscriber", "compiled": true, "compiled_code": "with base as (\n\n    select\n        \"id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"created_date\",\n  \"email_address\",\n  \"email_type_preference\",\n  \"status\",\n  \"subscriber_key\",\n  \"unsubscribed_date\"\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__subscriber_base\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_date\n    \n as \n    \n    created_date\n    \n, \n    \n    \n    email_address\n    \n as \n    \n    email_address\n    \n, \n    \n    \n    email_type_preference\n    \n as \n    \n    email_type_preference\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    subscriber_key\n    \n as \n    \n    subscriber_key\n    \n, \n    \n    \n    unsubscribed_date\n    \n as \n    \n    unsubscribed_date\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation,\n        cast(created_date as timestamp) as created_date,\n        email_address,\n        email_type_preference,\n        cast(id as TEXT) as subscriber_id,\n        status as subscriber_status,\n        subscriber_key,\n        cast(unsubscribed_date as timestamp) as unsubscribed_date\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__subscriber\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.076335Z", "completed_at": "2024-07-12T21:55:31.405270Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.405517Z", "completed_at": "2024-07-12T21:55:31.405521Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.36397790908813477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__list_subscriber", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select\n        \"id\",\n  \"_fivetran_synced\",\n  \"created_date\",\n  \"list_id\",\n  \"modified_date\",\n  \"status\",\n  \"subscriber_key\"\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list_subscriber_base\"\n),\n\nfields as (\n\n    select\n        \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n , \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as timestamp) as \n    \n    _fivetran_start\n    \n , \n    cast(null as timestamp) as \n    \n    _fivetran_end\n    \n , \n    \n    \n    created_date\n    \n as \n    \n    created_date\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    list_id\n    \n as \n    \n    list_id\n    \n, \n    \n    \n    modified_date\n    \n as \n    \n    modified_date\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    subscriber_key\n    \n as \n    \n    subscriber_key\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation,\n        created_date,\n        cast(id as TEXT) as list_subscriber_id,\n        cast(list_id as TEXT) as list_id,\n        modified_date,\n        status,\n        subscriber_key\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list_subscriber\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.430774Z", "completed_at": "2024-07-12T21:55:31.445361Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.445691Z", "completed_at": "2024-07-12T21:55:31.445697Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015617847442626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_stg_salesforce_marketing_cloud__link_send_source_relation__link_id__send_id.8c741399e7", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, link_id, send_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link_send\"\n    group by source_relation, link_id, send_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.439819Z", "completed_at": "2024-07-12T21:55:31.449252Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.449502Z", "completed_at": "2024-07-12T21:55:31.449506Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010344982147216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__link_send_link_id.2fe2a8c85d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect link_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link_send\"\nwhere link_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.446806Z", "completed_at": "2024-07-12T21:55:31.450170Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.450661Z", "completed_at": "2024-07-12T21:55:31.450664Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004331111907958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__link_send_send_id.9346ff2651", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect send_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link_send\"\nwhere send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.080653Z", "completed_at": "2024-07-12T21:55:31.428303Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.428952Z", "completed_at": "2024-07-12T21:55:31.428957Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3805372714996338, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__send", "compiled": true, "compiled_code": "with base as (\n\n    select\n        \"id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"bcc_email\",\n  \"created_date\",\n  \"duplicates\",\n  \"email_id\",\n  \"email_name\",\n  \"existing_undeliverables\",\n  \"existing_unsubscribes\",\n  \"forwarded_emails\",\n  \"from_address\",\n  \"from_name\",\n  \"hard_bounces\",\n  \"invalid_addresses\",\n  \"is_always_on\",\n  \"is_multipart\",\n  \"missing_addresses\",\n  \"modified_date\",\n  \"number_delivered\",\n  \"number_errored\",\n  \"number_excluded\",\n  \"number_sent\",\n  \"number_targeted\",\n  \"other_bounces\",\n  \"preview_url\",\n  \"send_date\",\n  \"soft_bounces\",\n  \"status\",\n  \"subject\",\n  \"unique_clicks\",\n  \"unique_opens\",\n  \"unsubscribes\"\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__send_base\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc_email\n    \n as \n    \n    bcc_email\n    \n, \n    \n    \n    created_date\n    \n as \n    \n    created_date\n    \n, \n    \n    \n    duplicates\n    \n as \n    \n    duplicates\n    \n, \n    \n    \n    email_id\n    \n as \n    \n    email_id\n    \n, \n    \n    \n    email_name\n    \n as \n    \n    email_name\n    \n, \n    \n    \n    existing_undeliverables\n    \n as \n    \n    existing_undeliverables\n    \n, \n    \n    \n    existing_unsubscribes\n    \n as \n    \n    existing_unsubscribes\n    \n, \n    \n    \n    forwarded_emails\n    \n as \n    \n    forwarded_emails\n    \n, \n    \n    \n    from_address\n    \n as \n    \n    from_address\n    \n, \n    \n    \n    from_name\n    \n as \n    \n    from_name\n    \n, \n    \n    \n    hard_bounces\n    \n as \n    \n    hard_bounces\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    invalid_addresses\n    \n as \n    \n    invalid_addresses\n    \n, \n    \n    \n    is_always_on\n    \n as \n    \n    is_always_on\n    \n, \n    \n    \n    is_multipart\n    \n as \n    \n    is_multipart\n    \n, \n    \n    \n    missing_addresses\n    \n as \n    \n    missing_addresses\n    \n, \n    \n    \n    modified_date\n    \n as \n    \n    modified_date\n    \n, \n    \n    \n    number_delivered\n    \n as \n    \n    number_delivered\n    \n, \n    \n    \n    number_errored\n    \n as \n    \n    number_errored\n    \n, \n    \n    \n    number_excluded\n    \n as \n    \n    number_excluded\n    \n, \n    \n    \n    number_sent\n    \n as \n    \n    number_sent\n    \n, \n    \n    \n    number_targeted\n    \n as \n    \n    number_targeted\n    \n, \n    \n    \n    other_bounces\n    \n as \n    \n    other_bounces\n    \n, \n    \n    \n    preview_url\n    \n as \n    \n    preview_url\n    \n, \n    \n    \n    send_date\n    \n as \n    \n    send_date\n    \n, \n    \n    \n    soft_bounces\n    \n as \n    \n    soft_bounces\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    unique_clicks\n    \n as \n    \n    unique_clicks\n    \n, \n    \n    \n    unique_opens\n    \n as \n    \n    unique_opens\n    \n, \n    \n    \n    unsubscribes\n    \n as \n    \n    unsubscribes\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation,\n        bcc_email,\n        created_date,\n        duplicates,\n        cast(email_id as TEXT) as email_id,\n        email_name,\n        existing_undeliverables,\n        existing_unsubscribes,\n        forwarded_emails,\n        from_address,\n        from_name,\n        hard_bounces,\n        cast(id as TEXT) as send_id,\n        invalid_addresses,\n        is_always_on,\n        is_multipart,\n        missing_addresses,\n        modified_date,\n        number_delivered,\n        number_errored,\n        number_excluded,\n        number_sent,\n        number_targeted,\n        other_bounces,\n        preview_url,\n        send_date,\n        soft_bounces,\n        status as send_status,\n        subject,\n        unique_clicks,\n        unique_opens,\n        unsubscribes\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__send\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.451474Z", "completed_at": "2024-07-12T21:55:31.458579Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.459218Z", "completed_at": "2024-07-12T21:55:31.459222Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008980035781860352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_stg_salesforce_marketing_cloud__email_source_relation__email_id.e5b01bb83c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, email_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__email\"\n    group by source_relation, email_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.455820Z", "completed_at": "2024-07-12T21:55:31.460161Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.460787Z", "completed_at": "2024-07-12T21:55:31.460790Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006049156188964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_stg_salesforce_marketing_cloud__link_source_relation__link_id.049a21341f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, link_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link\"\n    group by source_relation, link_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.461120Z", "completed_at": "2024-07-12T21:55:31.468093Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.468559Z", "completed_at": "2024-07-12T21:55:31.468565Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008960962295532227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__email_email_id.b1db16d3d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__email\"\nwhere email_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.464296Z", "completed_at": "2024-07-12T21:55:31.469050Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.473043Z", "completed_at": "2024-07-12T21:55:31.473052Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012585878372192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__link_link_id.51283cc011", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect link_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link\"\nwhere link_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.469376Z", "completed_at": "2024-07-12T21:55:31.474399Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.477959Z", "completed_at": "2024-07-12T21:55:31.477965Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010291099548339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_stg_salesforce_marketing_cloud__event_source_relation__event_id.ceccfdce1a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, event_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__event\"\n    group by source_relation, event_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.474916Z", "completed_at": "2024-07-12T21:55:31.482633Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.483367Z", "completed_at": "2024-07-12T21:55:31.483374Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009879112243652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__event_event_id.e996e89b9f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.479016Z", "completed_at": "2024-07-12T21:55:31.487082Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.488146Z", "completed_at": "2024-07-12T21:55:31.488154Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013627290725708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_stg_salesforce_marketing_cloud__list_source_relation__list_id.962470aecb", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, list_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list\"\n    group by source_relation, list_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.483926Z", "completed_at": "2024-07-12T21:55:31.489489Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.490344Z", "completed_at": "2024-07-12T21:55:31.490354Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00813603401184082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__list_list_id.667a6e4d7f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect list_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list\"\nwhere list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.493721Z", "completed_at": "2024-07-12T21:55:31.502671Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.503461Z", "completed_at": "2024-07-12T21:55:31.503470Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013547182083129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_stg_salesforce_marketing_cloud__subscriber_source_relation__subscriber_id.e900508855", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, subscriber_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__subscriber\"\n    group by source_relation, subscriber_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.499739Z", "completed_at": "2024-07-12T21:55:31.504332Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.508160Z", "completed_at": "2024-07-12T21:55:31.508170Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010579109191894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__subscriber_subscriber_id.249ef2add5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscriber_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__subscriber\"\nwhere subscriber_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.504954Z", "completed_at": "2024-07-12T21:55:31.509781Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.513053Z", "completed_at": "2024-07-12T21:55:31.513059Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010127067565917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_stg_salesforce_marketing_cloud__list_subscriber_source_relation__list_subscriber_id__list_id.915778b340", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, list_subscriber_id, list_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list_subscriber\"\n    group by source_relation, list_subscriber_id, list_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.509998Z", "completed_at": "2024-07-12T21:55:31.516518Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.516995Z", "completed_at": "2024-07-12T21:55:31.516999Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008363008499145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__list_subscriber_list_id.3954d36a3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect list_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list_subscriber\"\nwhere list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.513526Z", "completed_at": "2024-07-12T21:55:31.517527Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.527057Z", "completed_at": "2024-07-12T21:55:31.527063Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017584800720214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__list_subscriber_list_subscriber_id.645881c28f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect list_subscriber_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list_subscriber\"\nwhere list_subscriber_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.517972Z", "completed_at": "2024-07-12T21:55:31.528282Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.531131Z", "completed_at": "2024-07-12T21:55:31.531136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014460325241088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.salesforce_marketing_cloud__events_enhanced", "compiled": true, "compiled_code": "\n\n-- events grain with sends and email information added.\nwith events as( \n  select\n    *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__event\"\n\n  \n    \n      where event_date > (select max(event_date) from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__events_enhanced\")\n    \n  \n\n), events_enhanced as (\n  select\n    source_relation,\n    batch_id,\n    bounce_category,\n    bounce_type,\n    created_date,\n    event_date,\n    event_type,\n    event_id,\n    modified_date,\n    opt_in_subscriber_key,\n    question,\n    send_id,\n    smtp_code,\n    smtp_reason,\n    subscriber_key,\n    triggered_send_id,\n    unsubscribed_list_id,\n    event_url,\n    -- the below definitions are found here: https://developer.salesforce.com/docs/marketing/marketing-cloud/guide/eventtype.html\n    lower(event_type) = 'click' as is_click,\n    lower(event_type) = 'deliveredevent' as is_delivered_event,\n    lower(event_type) = 'forwardedemail' as is_forward,\n    lower(event_type) = 'forwardedemailoptin' as is_opt_in,\n    lower(event_type) in ('hardbounce', 'otherbounce', 'softbounce') as is_bounce,\n    lower(event_type) = 'open' as is_open,\n    lower(event_type) = 'notsent' as is_not_sent, \n    lower(event_type) = 'sent' as is_sent,\n    lower(event_type) = 'survey' as is_survey_response,\n    lower(event_type) = 'unsubscribe' as is_unsubscribe\n  from events\n\n), sends as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__send\"\n\n), emails as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__email\"\n\n), joined as (\n  select\n    events_enhanced.*,\n    sends.created_date as send_created_date,\n    sends.bcc_email,\n    sends.from_address,\n    sends.from_name,\n    sends.preview_url,\n    sends.subject as sends_subject,\n    sends.email_id,\n    emails.email_name,\n    emails.subject as email_subject,\n    emails.created_date as email_created_date\n  from events_enhanced\n  left join sends\n    on sends.send_id = events_enhanced.send_id\n    and sends.source_relation = events_enhanced.source_relation\n  left join emails\n    on emails.email_id = sends.email_id\n    and emails.source_relation = sends.source_relation\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__events_enhanced\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.528753Z", "completed_at": "2024-07-12T21:55:31.535077Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.535681Z", "completed_at": "2024-07-12T21:55:31.535686Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008275985717773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.salesforce_marketing_cloud__sends_links", "compiled": true, "compiled_code": "\n\n-- sends joined with links.\nwith sends as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__send\"\n\n), link_sends as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link_send\"\n\n), links as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__link\"\n\n), joined as (\n  select \n    sends.source_relation,\n    sends.send_id, \n    sends.bcc_email, \n    sends.duplicates, \n    sends.email_name, \n    sends.existing_undeliverables, \n    sends.existing_unsubscribes, \n    sends.forwarded_emails, \n    sends.from_address, \n    sends.from_name, \n    sends.hard_bounces, \n    sends.invalid_addresses, \n    sends.is_always_on, \n    sends.is_multipart, \n    sends.missing_addresses,\n    sends.number_delivered,\n    sends.number_errored,\n    sends.number_excluded,\n    sends.number_sent,\n    sends.number_targeted,\n    sends.other_bounces,\n    sends.preview_url,\n    sends.soft_bounces,\n    sends.send_status,\n    sends.subject,\n    sends.unique_clicks,\n    sends.unique_opens,\n    sends.unsubscribes,\n    sends.email_id,\n    sends.created_date as send_created_date,\n    sends.modified_date as send_modified_date,\n    sends.send_date,\n    link_sends.link_id,\n    links.link_alias,\n    links.link_total_clicks,\n    links.link_unique_clicks,\n    links.link_url,\n    links.link_last_clicked\n  from sends\n  left join link_sends\n    on link_sends.send_id = sends.send_id\n    and link_sends.source_relation = sends.source_relation\n  left join links\n    on links.link_id = link_sends.link_id\n    and links.source_relation = link_sends.source_relation\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__sends_links\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.532413Z", "completed_at": "2024-07-12T21:55:31.536545Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.539631Z", "completed_at": "2024-07-12T21:55:31.539635Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011188983917236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_stg_salesforce_marketing_cloud__send_source_relation__send_id.810c03976d", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, send_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__send\"\n    group by source_relation, send_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.536821Z", "completed_at": "2024-07-12T21:55:31.546775Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.548309Z", "completed_at": "2024-07-12T21:55:31.548315Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013036012649536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__send_send_id.f7ec052179", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect send_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__send\"\nwhere send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.540585Z", "completed_at": "2024-07-12T21:55:31.549286Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.554220Z", "completed_at": "2024-07-12T21:55:31.554225Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014896869659423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.salesforce_marketing_cloud__subscriber_lists", "compiled": true, "compiled_code": "\n\n-- subscribers joined with lists.\nwith  __dbt__cte__salesforce_marketing_cloud__subscribers_enhanced as (\nwith subscribers as ( \n  select \n    *,\n    lower(subscriber_status) = 'active' as is_active\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__subscriber\"\n)\n\nselect *\nfrom subscribers\n), subscribers as ( \n  select *\n  from __dbt__cte__salesforce_marketing_cloud__subscribers_enhanced\n\n), lists_subscribers as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list_subscriber\"\n\n), lists as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__list\"\n\n), joined as (\n  select\n    subscribers.source_relation,\n    subscribers.subscriber_id, \n    subscribers.email_address, \n    subscribers.email_type_preference, \n    subscribers.subscriber_key, \n    subscribers.subscriber_status, \n    subscribers.created_date, \n    subscribers.unsubscribed_date,\n    lists_subscribers.list_id, \n    lists.list_description, \n    lists.list_name, \n    lists.list_type, \n    lists.created_date as list_created_date, \n    lists.modified_date as list_modified_date\n  from subscribers\n  left join lists_subscribers\n    on lists_subscribers.subscriber_key = subscribers.subscriber_key\n    and lists_subscribers.source_relation = subscribers.source_relation\n  left join lists\n    on lists.list_id = lists_subscribers.list_id\n    and lists.source_relation = lists_subscribers.source_relation\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__subscriber_lists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.549497Z", "completed_at": "2024-07-12T21:55:31.555181Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.558497Z", "completed_at": "2024-07-12T21:55:31.558502Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010551929473876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.salesforce_marketing_cloud__email_overview", "compiled": true, "compiled_code": "-- aggregates at the email grain.\nwith emails as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__email\"\n\n), sends as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__send\"\n\n), sends_stats as (\n  select \n    emails.email_id,\n    emails.source_relation,\n    count(distinct sends.send_id) as total_unique_sends,\n    coalesce(sum(sends.number_sent), 0) as total_emails_sent,\n    coalesce(sum(sends.unique_opens), 0) as total_unique_opens,\n    coalesce(sum(sends.unique_clicks), 0) as total_unique_clicks,\n    coalesce(sum(sends.unsubscribes), 0) as total_unsubscribes,\n    coalesce(sum(sends.forwarded_emails), 0) as total_forwards,\n    coalesce(sum(sends.number_delivered), 0) as total_deliveries,\n    coalesce(sum(sends.number_targeted), 0) as total_targets,\n    coalesce(sum(sends.hard_bounces + sends.soft_bounces + sends.other_bounces), 0) as total_bounces\n  from emails\n  left join sends\n    on sends.email_id = emails.email_id\n    and sends.source_relation = emails.source_relation\n  group by 1,2\n\n), sends_aggs as (\n  select\n    sends_stats.*,\n    coalesce(\n    ( total_unique_opens ) / nullif( ( total_emails_sent ), 0)\n, 0) as open_rate,\n    coalesce(\n    ( total_unique_clicks ) / nullif( ( total_emails_sent ), 0)\n, 0) as click_through_rate,\n    coalesce(\n    ( total_unsubscribes ) / nullif( ( total_emails_sent ), 0)\n, 0) as unsubscribe_rate\n  from sends_stats\n\n), events_enhanced as ( \n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__events_enhanced\"\n\n), events_stats as (\n  select \n    emails.email_id,\n    emails.source_relation,\n    sum(case when events_enhanced.is_sent then 1 else 0 end) as total_send_events,\n    sum(case when events_enhanced.is_open then 1 else 0 end) as total_open_events,\n    sum(case when events_enhanced.is_click then 1 else 0 end) as total_click_events,\n    sum(case when events_enhanced.is_bounce then 1 else 0 end) as total_bounce_events,\n    sum(case when events_enhanced.is_forward then 1 else 0 end) as total_forward_events,\n    sum(case when events_enhanced.is_unsubscribe then 1 else 0 end) as total_unsubscribe_events,\n    sum(case when events_enhanced.is_survey_response then 1 else 0 end) as total_survey_response_events\n  from emails\n  left join sends\n    on sends.email_id = emails.email_id\n    and sends.source_relation = emails.source_relation\n  left join events_enhanced\n    on events_enhanced.send_id = sends.send_id\n    and events_enhanced.source_relation = sends.source_relation\n  group by 1,2\n\n), joined as (\n  select\n    emails.source_relation,\n    emails.asset_id,\n    emails.asset_type_id,\n    emails.character_set,\n    emails.created_date,\n    emails.email_id,\n    emails.modified_date,\n    emails.email_name,\n    emails.pre_header,\n    emails.subject,\n    emails.text_body,\n    sends_aggs.total_unique_sends,\n    sends_aggs.total_emails_sent,\n    sends_aggs.total_unique_opens,\n    sends_aggs.total_unique_clicks,\n    sends_aggs.total_unsubscribes,\n    sends_aggs.total_forwards,\n    sends_aggs.total_deliveries,\n    sends_aggs.total_targets,\n    sends_aggs.total_bounces,\n    sends_aggs.open_rate,\n    sends_aggs.click_through_rate,\n    sends_aggs.unsubscribe_rate,\n    events_stats.total_send_events,\n    events_stats.total_open_events,\n    events_stats.total_click_events,\n    events_stats.total_bounce_events,\n    events_stats.total_forward_events,\n    events_stats.total_unsubscribe_events,\n    events_stats.total_survey_response_events\n  from emails\n  left join sends_aggs\n    on sends_aggs.email_id = emails.email_id\n    and sends_aggs.source_relation = emails.source_relation\n  left join events_stats\n    on events_stats.email_id = emails.email_id\n    and events_stats.source_relation = emails.source_relation\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__email_overview\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.555381Z", "completed_at": "2024-07-12T21:55:31.559624Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.580300Z", "completed_at": "2024-07-12T21:55:31.580307Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02639484405517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.salesforce_marketing_cloud__sends_overview", "compiled": true, "compiled_code": "-- aggregates at the send grain.\nwith sends as (\n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__send\"\n\n), sends_aggs as (\n  select\n    sends.*,\n    coalesce(\n    ( unique_opens ) / nullif( ( number_sent ), 0)\n, 0) as open_rate,\n    coalesce(\n    ( unique_clicks ) / nullif( ( number_sent ), 0)\n, 0) as click_through_rate,\n    coalesce(\n    ( unsubscribes ) / nullif( ( number_sent ), 0)\n, 0) as unsubscribe_rate\n  from sends\n\n), events_enhanced as ( \n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__events_enhanced\"\n\n), events_stats as (\n  select \n    sends.source_relation,\n    sends.send_id,\n    sum(case when events_enhanced.is_sent then 1 else 0 end) as total_send_events,\n    sum(case when events_enhanced.is_open then 1 else 0 end) as total_open_events,\n    sum(case when events_enhanced.is_click then 1 else 0 end) as total_click_events,\n    sum(case when events_enhanced.is_bounce then 1 else 0 end) as total_bounce_events,\n    sum(case when events_enhanced.is_forward then 1 else 0 end) as total_forward_events,\n    sum(case when events_enhanced.is_unsubscribe then 1 else 0 end) as total_unsubscribe_events,\n    sum(case when events_enhanced.is_survey_response then 1 else 0 end) as total_survey_response_events\n  from sends\n  left join events_enhanced\n    on events_enhanced.send_id = sends.send_id\n    and events_enhanced.source_relation = sends.source_relation\n  group by 1,2\n\n), joined as (\n  select\n    sends_aggs.source_relation,\n    sends_aggs.bcc_email,\n    sends_aggs.created_date,\n    sends_aggs.duplicates,\n    sends_aggs.email_id,\n    sends_aggs.email_name,\n    sends_aggs.existing_undeliverables,\n    sends_aggs.existing_unsubscribes,\n    sends_aggs.forwarded_emails,\n    sends_aggs.from_address,\n    sends_aggs.from_name,\n    sends_aggs.hard_bounces,\n    sends_aggs.send_id,\n    sends_aggs.invalid_addresses,\n    sends_aggs.is_always_on,\n    sends_aggs.is_multipart,\n    sends_aggs.missing_addresses,\n    sends_aggs.modified_date,\n    sends_aggs.number_delivered,\n    sends_aggs.number_errored,\n    sends_aggs.number_excluded,\n    sends_aggs.number_sent,\n    sends_aggs.number_targeted,\n    sends_aggs.other_bounces,\n    sends_aggs.preview_url,\n    sends_aggs.send_date,\n    sends_aggs.soft_bounces,\n    sends_aggs.send_status,\n    sends_aggs.subject,\n    sends_aggs.unique_clicks,\n    sends_aggs.unique_opens,\n    sends_aggs.unsubscribes,\n    sends_aggs.open_rate,\n    sends_aggs.click_through_rate,\n    sends_aggs.unsubscribe_rate,\n    events_stats.total_send_events,\n    events_stats.total_open_events,\n    events_stats.total_click_events,\n    events_stats.total_bounce_events,\n    events_stats.total_forward_events,\n    events_stats.total_unsubscribe_events,\n    events_stats.total_survey_response_events\n  from sends_aggs\n  left join events_stats\n    on events_stats.send_id = sends_aggs.send_id\n    and events_stats.source_relation = sends_aggs.source_relation\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__sends_overview\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.559909Z", "completed_at": "2024-07-12T21:55:31.581599Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.585949Z", "completed_at": "2024-07-12T21:55:31.585954Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027762174606323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.salesforce_marketing_cloud__subscriber_overview", "compiled": true, "compiled_code": "-- aggregates at the subscriber grain\nwith  __dbt__cte__salesforce_marketing_cloud__subscribers_enhanced as (\nwith subscribers as ( \n  select \n    *,\n    lower(subscriber_status) = 'active' as is_active\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__subscriber\"\n)\n\nselect *\nfrom subscribers\n), subscribers as ( \n  select *\n  from __dbt__cte__salesforce_marketing_cloud__subscribers_enhanced\n\n), events_enhanced as ( \n  select *\n  from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__events_enhanced\"\n\n), aggs as (\n    select \n      subscribers.source_relation,\n      subscribers.subscriber_id,\n      subscribers.subscriber_key,\n      subscribers.created_date,\n      subscribers.email_address,\n      subscribers.email_type_preference,\n      subscribers.subscriber_status,\n      subscribers.is_active,\n      subscribers.unsubscribed_date,\n      case when subscribers.unsubscribed_date is not null \n        then \n        ((subscribers.unsubscribed_date)::date - (subscribers.created_date)::date)\n     \n        else \n        ((current_date)::date - (subscribers.created_date)::date)\n     \n      end as days_subscribed,\n      sum(case when events_enhanced.is_sent then 1 else 0 end) as number_of_sends,\n      max(case when events_enhanced.is_sent then events_enhanced.event_date end) as most_recent_send,\n      sum(case when events_enhanced.is_open then 1 else 0 end) as number_of_opens,\n      max(case when events_enhanced.is_open then events_enhanced.event_date end) as most_recent_open,\n      sum(case when events_enhanced.is_click then 1 else 0 end) as number_of_clicks,\n      max(case when events_enhanced.is_click then events_enhanced.event_date end) as most_recent_click,\n      sum(case when events_enhanced.is_bounce then 1 else 0 end) as number_of_bounces,\n      max(case when events_enhanced.is_bounce then events_enhanced.event_date end) as most_recent_bounce,\n      sum(case when events_enhanced.is_forward then 1 else 0 end) as number_of_forwards,\n      max(case when events_enhanced.is_forward then events_enhanced.event_date end) as most_recent_forward,\n      sum(case when events_enhanced.is_survey_response then 1 else 0 end) as number_of_survey_responses,\n      max(case when events_enhanced.is_survey_response then events_enhanced.event_date else null end) as most_recent_survey_response\n    from subscribers\n    left join events_enhanced\n        on events_enhanced.subscriber_key = subscribers.subscriber_key\n        and events_enhanced.source_relation = subscribers.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10\n)\n\nselect * \nfrom aggs", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__subscriber_overview\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.581859Z", "completed_at": "2024-07-12T21:55:31.589882Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.590547Z", "completed_at": "2024-07-12T21:55:31.590553Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010640859603881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_salesforce_marketing_cloud__events_enhanced_source_relation__event_id.096cceb8d1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, event_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__events_enhanced\"\n    group by source_relation, event_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.587030Z", "completed_at": "2024-07-12T21:55:31.591459Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.594867Z", "completed_at": "2024-07-12T21:55:31.594873Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009273052215576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_salesforce_marketing_cloud__events_enhanced_event_id.de6fbdd831", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__events_enhanced\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.591706Z", "completed_at": "2024-07-12T21:55:31.598652Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.599265Z", "completed_at": "2024-07-12T21:55:31.599271Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00913095474243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_salesforce_marketing_cloud__sends_links_source_relation__send_id__link_id.32cf74a41f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, send_id, link_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__sends_links\"\n    group by source_relation, send_id, link_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.595937Z", "completed_at": "2024-07-12T21:55:31.600156Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.603376Z", "completed_at": "2024-07-12T21:55:31.603381Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008840084075927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_salesforce_marketing_cloud__sends_links_send_id.c0a0146bac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect send_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__sends_links\"\nwhere send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.600394Z", "completed_at": "2024-07-12T21:55:31.606848Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.607366Z", "completed_at": "2024-07-12T21:55:31.607370Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008474111557006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_salesforce_marketing_cloud__subscriber_lists_source_relation__list_id__subscriber_id.87eb8263ca", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, list_id, subscriber_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__subscriber_lists\"\n    group by source_relation, list_id, subscriber_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.604292Z", "completed_at": "2024-07-12T21:55:31.608183Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.612564Z", "completed_at": "2024-07-12T21:55:31.612574Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009530067443847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_salesforce_marketing_cloud__subscriber_lists_subscriber_id.ca533518be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscriber_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__subscriber_lists\"\nwhere subscriber_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.608408Z", "completed_at": "2024-07-12T21:55:31.613563Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.616860Z", "completed_at": "2024-07-12T21:55:31.616864Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009843111038208008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_salesforce_marketing_cloud__email_overview_source_relation__email_id.623a6f440f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, email_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__email_overview\"\n    group by source_relation, email_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.613769Z", "completed_at": "2024-07-12T21:55:31.617842Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.621176Z", "completed_at": "2024-07-12T21:55:31.621182Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009046077728271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_salesforce_marketing_cloud__email_overview_email_id.e613150e55", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__email_overview\"\nwhere email_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.618037Z", "completed_at": "2024-07-12T21:55:31.622102Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.625048Z", "completed_at": "2024-07-12T21:55:31.625052Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008507013320922852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_salesforce_marketing_cloud__sends_overview_source_relation__send_id.bb4fd623a5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, send_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__sends_overview\"\n    group by source_relation, send_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.622306Z", "completed_at": "2024-07-12T21:55:31.628560Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.629049Z", "completed_at": "2024-07-12T21:55:31.629053Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008176088333129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_salesforce_marketing_cloud__sends_overview_send_id.90631a2265", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect send_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__sends_overview\"\nwhere send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.625950Z", "completed_at": "2024-07-12T21:55:31.629667Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.633501Z", "completed_at": "2024-07-12T21:55:31.633506Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008777856826782227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_salesforce_marketing_cloud__subscriber_overview_source_relation__subscriber_id.b1b5e44bff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, subscriber_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__subscriber_overview\"\n    group by source_relation, subscriber_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.629862Z", "completed_at": "2024-07-12T21:55:31.634106Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.634330Z", "completed_at": "2024-07-12T21:55:31.634333Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0056116580963134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_salesforce_marketing_cloud__subscriber_overview_subscriber_id.a90f1851be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscriber_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"salesforce_marketing_cloud__subscriber_overview\"\nwhere subscriber_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.424092Z", "completed_at": "2024-07-12T21:55:31.719732Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.720004Z", "completed_at": "2024-07-12T21:55:31.720011Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.32058119773864746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.salesforce_marketing_cloud.stg_salesforce_marketing_cloud__triggered_send", "compiled": true, "compiled_code": "with base as (\n\n    select\n        \"id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"auto_add_subscribers\",\n  \"auto_update_subscribers\",\n  \"bcc_email\",\n  \"created_date\",\n  \"description\",\n  \"dynamic_email_subject\",\n  \"email_id\",\n  \"email_subject\",\n  \"from_address\",\n  \"from_name\",\n  \"is_multipart\",\n  \"is_wrapped\",\n  \"list_id\",\n  \"modified_date\",\n  \"name\",\n  \"priority\",\n  \"send_limit\",\n  \"send_window_close\",\n  \"send_window_open\",\n  \"triggered_send_status\"\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__triggered_send_base\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    auto_add_subscribers\n    \n as \n    \n    auto_add_subscribers\n    \n, \n    \n    \n    auto_update_subscribers\n    \n as \n    \n    auto_update_subscribers\n    \n, \n    \n    \n    bcc_email\n    \n as \n    \n    bcc_email\n    \n, \n    \n    \n    created_date\n    \n as \n    \n    created_date\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    dynamic_email_subject\n    \n as \n    \n    dynamic_email_subject\n    \n, \n    \n    \n    email_id\n    \n as \n    \n    email_id\n    \n, \n    \n    \n    email_subject\n    \n as \n    \n    email_subject\n    \n, \n    \n    \n    from_address\n    \n as \n    \n    from_address\n    \n, \n    \n    \n    from_name\n    \n as \n    \n    from_name\n    \n, \n    \n    \n    is_multipart\n    \n as \n    \n    is_multipart\n    \n, \n    \n    \n    is_wrapped\n    \n as \n    \n    is_wrapped\n    \n, \n    \n    \n    list_id\n    \n as \n    \n    list_id\n    \n, \n    \n    \n    modified_date\n    \n as \n    \n    modified_date\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    priority\n    \n as \n    \n    priority\n    \n, \n    \n    \n    send_limit\n    \n as \n    \n    send_limit\n    \n, \n    \n    \n    send_window_close\n    \n as \n    \n    send_window_close\n    \n, \n    \n    \n    send_window_open\n    \n as \n    \n    send_window_open\n    \n, \n    \n    \n    triggered_send_status\n    \n as \n    \n    triggered_send_status\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation,\n        id as triggered_send_id,\n        email_id,\n        list_id,\n        auto_add_subscribers,\n        auto_update_subscribers,\n        bcc_email,\n        created_date,\n        modified_date,\n        description as triggered_send_description,\n        dynamic_email_subject,\n        email_subject,\n        from_address,\n        from_name,\n        is_multipart,\n        is_wrapped,\n        name as triggered_send_name,\n        priority,\n        send_limit,\n        send_window_close,\n        send_window_open,\n        triggered_send_status\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__triggered_send\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.746411Z", "completed_at": "2024-07-12T21:55:31.752504Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.752742Z", "completed_at": "2024-07-12T21:55:31.752748Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007356166839599609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.dbt_utils_unique_combination_of_columns_stg_salesforce_marketing_cloud__triggered_send_source_relation__triggered_send_id.1fb2402202", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, triggered_send_id\n    from \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__triggered_send\"\n    group by source_relation, triggered_send_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-12T21:55:31.749697Z", "completed_at": "2024-07-12T21:55:31.753162Z"}, {"name": "execute", "started_at": "2024-07-12T21:55:31.753360Z", "completed_at": "2024-07-12T21:55:31.753363Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0076580047607421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.salesforce_marketing_cloud.not_null_stg_salesforce_marketing_cloud__triggered_send_triggered_send_id.d1a27e5ca8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect triggered_send_id\nfrom \"postgres\".\"sfmc_integration_tests_06_salesforce_marketing_cloud\".\"stg_salesforce_marketing_cloud__triggered_send\"\nwhere triggered_send_id is null\n\n\n", "relation_name": null}], "elapsed_time": 2.3922572135925293, "args": {"indirect_selection": "eager", "use_colors": true, "cache_selected_only": false, "static": false, "vars": {}, "write_json": true, "log_level": "info", "quiet": false, "log_level_file": "debug", "compile": true, "partial_parse": true, "require_resource_names_without_spaces": false, "which": "generate", "partial_parse_file_diff": true, "macro_debugging": false, "project_dir": "/Users/joseph.markiewicz/Documents/dbt_packages/salesforce_marketing_cloud/dbt_salesforce_marketing_cloud/integration_tests", "print": true, "profiles_dir": "/Users/joseph.markiewicz/.dbt", "source_freshness_run_project_hooks": false, "static_parser": true, "strict_mode": false, "send_anonymous_usage_stats": true, "enable_legacy_logger": false, "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "target": "postgres", "exclude": [], "log_path": "/Users/joseph.markiewicz/Documents/dbt_packages/salesforce_marketing_cloud/dbt_salesforce_marketing_cloud/integration_tests/logs", "log_file_max_bytes": 10485760, "empty_catalog": false, "log_format_file": "debug", "populate_cache": true, "use_colors_file": true, "introspect": true, "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "version_check": true, "defer": false, "log_format": "default", "select": [], "invocation_command": "dbt docs generate -t postgres", "printer_width": 80}}